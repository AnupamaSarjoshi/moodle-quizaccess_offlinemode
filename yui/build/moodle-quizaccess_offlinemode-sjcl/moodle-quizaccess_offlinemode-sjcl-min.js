YUI.add("moodle-quizaccess_offlinemode-sjcl",function(t,e){"use strict";var i,v={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};v.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,i,n,r,s,o=this._tables[0][4],a=this._tables[1],c=t.length,h=1;if(4!==c&&6!==c&&8!==c)throw new v.exception.invalid("invalid aes key size");for(this._key=[r=t.slice(0),s=[]],e=c;e<4*c+28;e++)n=r[e-1],(e%c==0||8===c&&e%c==4)&&(n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[255&n],e%c==0&&(n=n<<8^n>>>24^h<<24,h=h<<1^283*(h>>7))),r[e]=r[e-c]^n;for(i=0;e;i++,e--)n=r[3&i?e:e-4],s[i]=e<=4||i<4?n:a[0][o[n>>>24]]^a[1][o[n>>16&255]]^a[2][o[n>>8&255]]^a[3][o[255&n]]},v.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,i,n,r,s,o,a,c=this._tables[0],h=this._tables[1],f=c[4],u=h[4],l=[],d=[];for(t=0;t<256;t++)d[(l[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!f[e];e^=n||1,i=d[i]||1)for(s=(s=i^i<<1^i<<2^i<<3^i<<4)>>8^255&s^99,a=16843009*l[r=l[n=l[u[f[e]=s]=e]]]^65537*r^257*n^16843008*e,o=257*l[s]^16843008*s,t=0;t<4;t++)c[t][e]=o=o<<24^o>>>8,h[t][s]=a=a<<24^a>>>8;for(t=0;t<5;t++)c[t]=c[t].slice(0),h[t]=h[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new v.exception.invalid("invalid aes block size");var i,n,r,s,o=this._key[e],a=t[0]^o[0],c=t[e?3:1]^o[1],h=t[2]^o[2],f=t[e?1:3]^o[3],u=o.length/4-2,l=4,d=[0,0,0,0],p=this._tables[e],b=p[0],m=p[1],_=p[2],g=p[3],y=p[4];for(s=0;s<u;s++)i=b[a>>>24]^m[c>>16&255]^_[h>>8&255]^g[255&f]^o[l],n=b[c>>>24]^m[h>>16&255]^_[f>>8&255]^g[255&a]^o[l+1],r=b[h>>>24]^m[f>>16&255]^_[a>>8&255]^g[255&c]^o[l+2],f=b[f>>>24]^m[a>>16&255]^_[c>>8&255]^g[255&h]^o[l+3],l+=4,a=i,c=n,h=r;for(s=0;s<4;s++)d[e?3&-s:s]=y[a>>>24]<<24^y[c>>16&255]<<16^y[h>>8&255]<<8^y[255&f]^o[l++],i=a,a=c,c=h,h=f,f=i;return d}},v.bitArray={bitSlice:function(t,e,i){return t=v.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),i===undefined?t:v.bitArray.clamp(t,i-e)},extract:function(t,e,i){var n=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],n=v.bitArray.getPartial(i);return 32===n?t.concat(e):v.bitArray._shiftRight(e,n,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e,i=t.length;return 0===i?0:(e=t[i-1],32*(i-1)+v.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<i&&e&&(t[i-1]=v.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(v.bitArray.bitLength(t)!==v.bitArray.bitLength(e))return!1;var i,n=0;for(i=0;i<t.length;i++)n|=t[i]^e[i];return 0===n},_shiftRight:function(t,e,i,n){var r,s,o;for(n===undefined&&(n=[]);32<=e;e-=32)n.push(i),i=0;if(0===e)return n.concat(t);for(r=0;r<t.length;r++)n.push(i|t[r]>>>e),i=t[r]<<32-e;return s=t.length?t[t.length-1]:0,o=v.bitArray.getPartial(s),n.push(v.bitArray.partial(e+o&31,32<e+o?i:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,i;for(e=0;e<t.length;++e)i=t[e],t[e]=i>>>24|i>>>8&65280|(65280&i)<<8|i<<24;return t}},v.codec.utf8String={fromBits:function(t){var e,i,n="",r=v.bitArray.bitLength(t);for(e=0;e<r/8;e++)0==(3&e)&&(i=t[e/4]),n+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3==(3&e)&&(i.push(n),n=0);return 3&e&&i.push(v.bitArray.partial(8*(3&e),n)),i}},v.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return i.substr(0,v.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,n=[];for(i=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return v.bitArray.clamp(n,4*i)}},v.codec.base32={_chars:"0123456789abcdefghjkmnpqrstvwxyz",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e){v.codec.base32.BITS;var i,n=v.codec.base32.BASE,r=v.codec.base32.REMAINING,s="",o=0,a=v.codec.base32._chars,c=0,h=v.bitArray.bitLength(t);for(i=0;s.length*n<=h;)s+=a.charAt((c^t[i]>>>o)>>>r),o<n?(c=t[i]<<n-o,o+=r,i++):(c<<=n,o-=n);return s},toBits:function(t){var e,i,n=v.codec.base32.BITS,r=v.codec.base32.BASE,s=v.codec.base32.REMAINING,o=[],a=0,c=v.codec.base32._chars,h=0;for(e=0;e<t.length;e++){if((i=c.indexOf(t.charAt(e)))<0)throw new v.exception.invalid("this isn't base32!");s<a?(a-=s,o.push(h^i>>>a),h=i<<n-a):h^=i<<n-(a+=r)}return 56&a&&o.push(v.bitArray.partial(56&a,h,1)),o}},v.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var n,r="",s=0,o=v.codec.base64._chars,a=0,c=v.bitArray.bitLength(t);for(i&&(o=o.substr(0,62)+"-_"),n=0;6*r.length<c;)r+=o.charAt((a^t[n]>>>s)>>>26),s<6?(a=t[n]<<6-s,s+=26,n++):(a<<=6,s-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,n,r=[],s=0,o=v.codec.base64._chars,a=0;for(e&&(o=o.substr(0,62)+"-_"),i=0;i<t.length;i++){if((n=o.indexOf(t.charAt(i)))<0)throw new v.exception.invalid("this isn't base64!");26<s?(s-=26,r.push(a^n>>>s),a=n<<32-s):a^=n<<32-(s+=6)}return 56&s&&r.push(v.bitArray.partial(56&s,a,1)),r}},v.codec.base64url={fromBits:function(t){return v.codec.base64.fromBits(t,1,1)},toBits:function(t){return v.codec.base64.toBits(t,1)}},
v.codec.bytes={fromBits:function(t){var e,i,n=[],r=v.bitArray.bitLength(t);for(e=0;e<r/8;e++)0==(3&e)&&(i=t[e/4]),n.push(i>>>24),i<<=8;return n},toBits:function(t){var e,i=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t[e],3==(3&e)&&(i.push(n),n=0);return 3&e&&i.push(v.bitArray.partial(8*(3&e),n)),i}},v.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},v.hash.sha256.hash=function(t){return(new v.hash.sha256).update(t).finalize()},v.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=v.codec.utf8String.toBits(t));var e,i=this._buffer=v.bitArray.concat(this._buffer,t),n=this._length,r=this._length=n+v.bitArray.bitLength(t);for(e=512+n&-512;e<=r;e+=512)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(t=(e=v.bitArray.concat(e,[v.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[],_key:[],_precompute:function(){var t,e=0,i=2;function n(t){return 4294967296*(t-Math.floor(t))|0}t:for(;e<64;i++){for(t=2;t*t<=i;t++)if(i%t==0)continue t;e<8&&(this._init[e]=n(Math.pow(i,.5))),this._key[e]=n(Math.pow(i,1/3)),e++}},_block:function(t){var e,i,n,r,s=t.slice(0),o=this._h,a=this._key,c=o[0],h=o[1],f=o[2],u=o[3],l=o[4],d=o[5],p=o[6],b=o[7];for(e=0;e<64;e++)i=(i=e<16?s[e]:(n=s[e+1&15],r=s[e+14&15],s[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+s[15&e]+s[e+9&15]|0))+b+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(p^l&(d^p))+a[e],b=p,p=d,d=l,l=u+i|0,u=f,f=h,c=i+((h=c)&f^u&(h^f))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;o[0]=o[0]+c|0,o[1]=o[1]+h|0,o[2]=o[2]+f|0,o[3]=o[3]+u|0,o[4]=o[4]+l|0,o[5]=o[5]+d|0,o[6]=o[6]+p|0,o[7]=o[7]+b|0}},v.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},v.hash.sha512.hash=function(t){return(new v.hash.sha512).update(t).finalize()},v.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=v.codec.utf8String.toBits(t));var e,i=this._buffer=v.bitArray.concat(this._buffer,t),n=this._length,r=this._length=n+v.bitArray.bitLength(t);for(e=1024+n&-1024;e<=r;e+=1024)this._block(i.splice(0,32));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(t=(e=v.bitArray.concat(e,[v.bitArray.partial(1,1)])).length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32));return this.reset(),i},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){var t,e=0,i=2;function n(t){return 4294967296*(t-Math.floor(t))|0}function r(t){return 1099511627776*(t-Math.floor(t))&255}t:for(;e<80;i++){for(t=2;t*t<=i;t++)if(i%t==0)continue t;e<8&&(this._init[2*e]=n(Math.pow(i,.5)),this._init[2*e+1]=r(Math.pow(i,.5))<<24|this._initr[e]),this._key[2*e]=n(Math.pow(i,1/3)),this._key[2*e+1]=r(Math.pow(i,1/3))<<24|this._keyr[e],e++}},_block:function(t){var e,i,n,r,s,o,a,c,h,f,u,l,d,p,b,m,_,g,y,v,w,E=t.slice(0),A=this._h,x=this._key,B=A[0],k=A[1],C=A[2],M=A[3],D=A[4],S=A[5],L=A[6],F=A[7],R=A[8],z=A[9],I=A[10],q=A[11],O=A[12],T=A[13],K=A[14],P=A[15],G=B,j=k,N=C,U=M,V=D,Y=S,J=L,H=F,W=R,X=z,Q=I,$=q,Z=O,tt=T,et=K,it=P;for(e=0;e<80;e++)e<16?(i=E[2*e],n=E[2*e+1]):(r=E[2*(e-15)],o=((s=E[2*(e-15)+1])<<31|r>>>1)^(s<<24|r>>>8)^r>>>7,a=(r<<31|s>>>1)^(r<<24|s>>>8)^(r<<25|s>>>7),c=E[2*(e-2)],f=((h=E[2*(e-2)+1])<<13|c>>>19)^(c<<3|h>>>29)^c>>>6,u=(c<<13|h>>>19)^(h<<3|c>>>29)^(c<<26|h>>>6),i=o+E[2*(e-7)]+((n=a+E[2*(e-7)+1])>>>0<a>>>0?1:0),i+=f+((n+=u)>>>0<u>>>0?1:0),i+=E[2*(e-16)]+((n+=l=E[2*(e-16)+1])>>>0<l>>>0?1:0)),E[2*e]=i|=0,E[2*e+1]=n|=0,p=G&N^G&V^N&V,b=j&U^j&Y^U&Y,m=(j<<4|G>>>28)^(G<<30|j>>>2)^(G<<25|j>>>7),_=(G<<4|j>>>28)^(j<<30|G>>>2)^(j<<25|G>>>7),v=et+((X<<18|W>>>14)^(X<<14|W>>>18)^(W<<23|X>>>9))+((y=it+((W<<18|X>>>14)^(W<<14|X>>>18)^(X<<23|W>>>9)))>>>0<it>>>0?1:0),v+=(W&Q^~W&Z)+((y+=d=X&$^~X&tt)>>>0<d>>>0?1:0),v+=x[2*e]+((y+=g=x[2*e+1])>>>0<g>>>0?1:0),et=Z,it=tt,Z=Q,tt=$,Q=W,$=X,W=J+(v+=i+((y=y+n|0)>>>0<n>>>0?1:0))+((X=H+y|0)>>>0<H>>>0?1:0)|0,J=V,H=Y,V=N,Y=U,N=G,U=j,G=v+(m+p+((w=_+b)>>>0<_>>>0?1:0))+((j=y+w|0)>>>0<y>>>0?1:0)|0;k=A[1]=k+j|0,A[0]=B+G+(k>>>0<j>>>0?1:0)|0,M=A[3]=M+U|0,A[2]=C+N+(M>>>0<U>>>0?1:0)|0,S=A[5]=S+Y|0,A[4]=D+V+(S>>>0<Y>>>0?1:0)|0,F=A[7]=F+H|0,A[6]=L+J+(F>>>0<H>>>0?1:0)|0,z=A[9]=z+X|0,A[8]=R+W+(z>>>0<X>>>0?1:0)|0,q=A[11]=q+$|0,A[10]=I+Q+(q>>>0<$>>>0?1:0)|0,T=A[13]=T+tt|0,A[12]=O+Z+(T>>>0<tt>>>0?1:0)|0,P=A[15]=P+it|0,A[14]=K+et+(P>>>0<it>>>0?1:0)|0}},v.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},v.hash.sha1.hash=function(t){return(new v.hash.sha1).update(t).finalize()},v.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=v.codec.utf8String.toBits(t));var e,
i=this._buffer=v.bitArray.concat(this._buffer,t),n=this._length,r=this._length=n+v.bitArray.bitLength(t);for(e=this.blockSize+n&-this.blockSize;e<=r;e+=this.blockSize)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(t=(e=v.bitArray.concat(e,[v.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,i,n){return t<=19?e&i|~e&n:t<=39?e^i^n:t<=59?e&i|e&n|i&n:t<=79?e^i^n:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){var e,i,n,r,s,o,a,c=t.slice(0),h=this._h;for(n=h[0],r=h[1],s=h[2],o=h[3],a=h[4],e=0;e<=79;e++)16<=e&&(c[e]=this._S(1,c[e-3]^c[e-8]^c[e-14]^c[e-16])),i=this._S(5,n)+this._f(e,r,s,o)+a+c[e]+this._key[Math.floor(e/20)]|0,a=o,o=s,s=this._S(30,r),r=n,n=i;h[0]=h[0]+n|0,h[1]=h[1]+r|0,h[2]=h[2]+s|0,h[3]=h[3]+o|0,h[4]=h[4]+a|0}},v.mode.ccm={name:"ccm",encrypt:function(t,e,i,n,r){var s,o,a=e.slice(0),c=v.bitArray,h=c.bitLength(i)/8,f=c.bitLength(a)/8;if(r=r||64,n=n||[],h<7)throw new v.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&f>>>8*s;s++);return s<15-h&&(s=15-h),i=c.clamp(i,8*(15-s)),o=v.mode.ccm._computeTag(t,e,i,n,r,s),a=v.mode.ccm._ctrMode(t,a,i,o,r,s),c.concat(a.data,a.tag)},decrypt:function(t,e,i,n,r){r=r||64,n=n||[];var s,o,a=v.bitArray,c=a.bitLength(i)/8,h=a.bitLength(e),f=a.clamp(e,h-r),u=a.bitSlice(e,h-r);if(h=(h-r)/8,c<7)throw new v.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&h>>>8*s;s++);if(s<15-c&&(s=15-c),i=a.clamp(i,8*(15-s)),f=v.mode.ccm._ctrMode(t,f,i,u,r,s),o=v.mode.ccm._computeTag(t,f.data,i,n,r,s),!a.equal(f.tag,o))throw new v.exception.corrupt("ccm: tag doesn't match");return f.data},_computeTag:function(t,e,i,n,r,s){var o,a,c,h=[],f=v.bitArray,u=f._xor4;if((r/=8)%2||r<4||16<r)throw new v.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<e.length)throw new v.exception.bug("ccm: can't deal with 4GiB or more data");if(o=[f.partial(8,(n.length?64:0)|r-2<<2|s-1)],(o=f.concat(o,i))[3]|=f.bitLength(e)/8,o=t.encrypt(o),n.length)for((a=f.bitLength(n)/8)<=65279?h=[f.partial(16,a)]:a<=4294967295&&(h=f.concat([f.partial(16,65534)],[a])),h=f.concat(h,n),c=0;c<h.length;c+=4)o=t.encrypt(u(o,h.slice(c,c+4).concat([0,0,0])));for(c=0;c<e.length;c+=4)o=t.encrypt(u(o,e.slice(c,c+4).concat([0,0,0])));return f.clamp(o,8*r)},_ctrMode:function(t,e,i,n,r,s){var o,a,c,h=v.bitArray,f=h._xor4,u=e.length,l=h.bitLength(e);if(c=h.concat([h.partial(8,s-1)],i).concat([0,0,0]).slice(0,4),n=h.bitSlice(f(n,t.encrypt(c)),0,r),!u)return{tag:n,data:[]};for(a=0;a<u;a+=4)c[3]++,o=t.encrypt(c),e[a]^=o[0],e[a+1]^=o[1],e[a+2]^=o[2],e[a+3]^=o[3];return{tag:n,data:h.clamp(e,l)}}},v.beware===undefined&&(v.beware={}),v.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){v.mode.cbc={name:"cbc",encrypt:function(t,e,i,n){if(n&&n.length)throw new v.exception.invalid("cbc can't authenticate data");if(128!==v.bitArray.bitLength(i))throw new v.exception.invalid("cbc iv must be 128 bits");var r,s=v.bitArray,o=s._xor4,a=s.bitLength(e),c=0,h=[];if(7&a)throw new v.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(r=0;c+128<=a;r+=4,c+=128)i=t.encrypt(o(i,e.slice(r,r+4))),h.splice(r,0,i[0],i[1],i[2],i[3]);return a=16843009*(16-(a>>3&15)),i=t.encrypt(o(i,s.concat(e,[a,a,a,a]).slice(r,r+4))),h.splice(r,0,i[0],i[1],i[2],i[3]),h},decrypt:function(t,e,i,n){if(n&&n.length)throw new v.exception.invalid("cbc can't authenticate data");if(128!==v.bitArray.bitLength(i))throw new v.exception.invalid("cbc iv must be 128 bits");if(127&v.bitArray.bitLength(e)||!e.length)throw new v.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var r,s,o,a=v.bitArray,c=a._xor4,h=[];for(n=n||[],r=0;r<e.length;r+=4)s=e.slice(r,r+4),o=c(i,t.decrypt(s)),h.splice(r,0,o[0],o[1],o[2],o[3]),i=s;if(0===(s=255&h[r-1])||16<s)throw new v.exception.corrupt("pkcs#5 padding corrupt");if(o=16843009*s,!a.equal(a.bitSlice([o,o,o,o],0,8*s),a.bitSlice(h,32*h.length-8*s,32*h.length)))throw new v.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(h,0,32*h.length-8*s)}}},v.mode.gcm={name:"gcm",encrypt:function(t,e,i,n,r){var s,o=e.slice(0),a=v.bitArray;return r=r||128,n=n||[],s=v.mode.gcm._ctrMode(!0,t,o,n,i,r),a.concat(s.data,s.tag)},decrypt:function(t,e,i,n,r){var s,o,a=e.slice(0),c=v.bitArray,h=c.bitLength(a);if(n=n||[],a=(r=r||128)<=h?(o=c.bitSlice(a,h-r),c.bitSlice(a,0,h-r)):(o=a,[]),s=v.mode.gcm._ctrMode(!1,t,a,n,i,r),!c.equal(s.tag,o))throw new v.exception.corrupt("gcm: tag doesn't match");return s.data},_galoisMultiply:function(t,e){var i,n,r,s,o,a=v.bitArray._xor4;for(r=[0,0,0,0],s=e.slice(0),i=0;i<128;i++){for(0!=(t[Math.floor(i/32)]&1<<31-i%32)&&(r=a(r,s)),o=0!=(1&s[3]),n=3;0<n;n--)s[n]=s[n]>>>1|(1&s[n-1])<<31;s[0]=s[0]>>>1,o&&(s[0]=s[0]^225<<24)}return r},_ghash:function(t,e,i){var n,r,s=i.length;for(n=e.slice(0),r=0;r<s;r+=4)n[0]^=4294967295&i[r],n[1]^=4294967295&i[r+1],n[2]^=4294967295&i[r+2],n[3]^=4294967295&i[r+3],n=v.mode.gcm._galoisMultiply(n,t);return n},_ctrMode:function(t,e,i,n,r,s){var o,a,c,h,f,u,l,d,p,b,m,_,g=v.bitArray;for(p=i.length,b=g.bitLength(i),m=g.bitLength(n),_=g.bitLength(r),o=e.encrypt([0,0,0,0]),a=96===_?(a=r.slice(0),g.concat(a,[1])):(a=v.mode.gcm._ghash(o,[0,0,0,0],r),v.mode.gcm._ghash(o,a,[0,0,Math.floor(_/4294967296),4294967295&_])),c=v.mode.gcm._ghash(o,[0,0,0,0],n),u=a.slice(0),l=c.slice(0),t||(l=v.mode.gcm._ghash(o,c,i)),f=0;f<p;f+=4)u[3]++,h=e.encrypt(u),i[f]^=h[0],i[f+1]^=h[1],i[f+2]^=h[2],i[f+3]^=h[3];return i=g.clamp(i,b),t&&(l=v.mode.gcm._ghash(o,c,i)),d=[Math.floor(m/4294967296),4294967295&m,Math.floor(b/4294967296),4294967295&b],l=v.mode.gcm._ghash(o,l,d),h=e.encrypt(a),l[0]^=h[0],l[1]^=h[1],l[2]^=h[2],l[3]^=h[3],{tag:g.bitSlice(l,0,
s),data:i}}},v.misc.hmac=function(t,e){this._hash=e=e||v.hash.sha256;var i,n=[[],[]],r=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>r&&(t=e.hash(t)),i=0;i<r;i++)n[0][i]=909522486^t[i],n[1][i]=1549556828^t[i];this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1]),this._resultHash=new e(this._baseHash[0])},v.misc.hmac.prototype.encrypt=v.misc.hmac.prototype.mac=function(t){if(this._updated)throw new v.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},v.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},v.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},v.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},v.misc.pbkdf2=function(t,e,i,n,r){if(i=i||1e3,n<0||i<0)throw v.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=v.codec.utf8String.toBits(t)),"string"==typeof e&&(e=v.codec.utf8String.toBits(e));var s,o,a,c,h,f=new(r=r||v.misc.hmac)(t),u=[],l=v.bitArray;for(h=1;32*u.length<(n||1);h++){for(s=o=f.encrypt(l.concat(e,[h])),a=1;a<i;a++)for(o=f.encrypt(o),c=0;c<o.length;c++)s[c]^=o[c];u=u.concat(s)}return n&&(u=l.clamp(u,n)),u},v.prng=function(t){this._pools=[new v.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=undefined,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},v.prng.prototype={randomWords:function(t,e){var i,n,r=[],s=this.isReady(e);if(s===this._NOT_READY)throw new v.exception.notReady("generator isn't seeded");for(s&this._REQUIRES_RESEED&&this._reseedFromPools(!(s&this._READY)),i=0;i<t;i+=4)(i+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),n=this._gen4words(),r.push(n[0],n[1],n[2],n[3]);return this._gate(),r.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user";var n,r,s,o,a=(new Date).valueOf(),c=this._robins[i],h=this.isReady(),f=0;switch((n=this._collectorIds[i])===undefined&&(n=this._collectorIds[i]=this._collectorIdNext++),c===undefined&&(c=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,typeof t){case"number":e===undefined&&(e=1),this._pools[c].update([n,this._eventId++,1,e,a,1,0|t]);break;case"object":if("[object Uint32Array]"===(o=Object.prototype.toString.call(t))){for(s=[],r=0;r<t.length;r++)s.push(t[r]);t=s}else for("[object Array]"!==o&&(f=1),r=0;r<t.length&&!f;r++)"number"!=typeof t[r]&&(f=1);if(!f){if(e===undefined)for(r=e=0;r<t.length;r++)for(s=t[r];0<s;)e++,s>>>=1;this._pools[c].update([n,this._eventId++,2,e,a,t.length].concat(t))}break;case"string":e===undefined&&(e=t.length),this._pools[c].update([n,this._eventId++,3,e,a,t.length]),this._pools[c].update(t);break;default:f=1}if(f)throw new v.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[c]+=e,this._poolStrength+=e,h===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[t!==undefined?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=e||this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new v.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent(
"keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,n,r=this._callbacks[t],s=[];for(n in r)r.hasOwnProperty(n)&&r[n]===e&&s.push(n);for(i=0;i<s.length;i++)delete r[n=s[i]]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new v.cipher.aes(this._key)},_reseed:function(t){this._key=v.hash.sha256.hash(this._key.concat(t)),this._cipher=new v.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],n=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;e<16;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),n+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new v.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(n){i=e=0}0!=e&&0!=i&&v.random.addEntropy([e,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(t){var e=t.touches[0]||t.changedTouches[0],i=e.pageX||e.clientX,n=e.pageY||e.clientY;v.random.addEntropy([i,n],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?v.random.addEntropy(window.performance.now(),t,"loadtime"):v.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e,i=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;window.orientation&&"number"==typeof(e=window.orientation)&&v.random.addEntropy(e,1,"accelerometer"),i&&v.random.addEntropy(i,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var i,n=v.random._callbacks[t],r=[];for(i in n)n.hasOwnProperty(i)&&r.push(n[i]);for(i=0;i<r.length;i++)r[i](e)}},v.random=new v.prng(6),function(){try{var t,e,i;if("undefined"!=typeof module&&module.exports&&(e=function n(){try{return require("crypto")}catch(t){return null}}())&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),v.random.addEntropy(t,1024,"crypto.randomBytes");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(i=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}v.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(r){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(r))}}(),v.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(t,e,i,n){i=i||{},n=n||{};var r,s,o,a=v.json,c=a._add({iv:v.random.randomWords(4,0)},a.defaults);if(a._add(c,i),o=c.adata,"string"==typeof c.salt&&(c.salt=v.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=v.codec.base64.toBits(c.iv)),!v.mode[c.mode]||!v.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||c.iv.length<2||4<c.iv.length)throw new v.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(t=(r=v.misc.cachedPbkdf2(t,c)).key.slice(0,c.ks/32),c.salt=r.salt):v.ecc&&t instanceof v.ecc.elGamal.publicKey&&(r=t.kem(),c.kemtag=r.tag,t=r.key.slice(0,c.ks/32)),"string"==typeof e&&(e=v.codec.utf8String.toBits(e)),"string"==typeof o&&(o=v.codec.utf8String.toBits(o)),s=new v.cipher[c.cipher](t),a._add(n,c),n.key=t,c.ct=v.mode[c.mode].encrypt(s,e,c.iv,o,c.ts),c},encrypt:function(t,e,i,n){var r=v.json,s=r._encrypt.apply(r,arguments);return r.encode(s)},_decrypt:function(t,e,i,n){i=i||{},n=n||{};var r,s,o,a=v.json,c=a._add(a._add(a._add({},a.defaults),e),i,!0),h=c.adata;if("string"==typeof c.salt&&(c.salt=v.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=v.codec.base64.toBits(c.iv)),!v.mode[c.mode]||!v.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||!c.iv||c.iv.length<2||4<c.iv.length)throw new v.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(t=(s=v.misc.cachedPbkdf2(t,c)).key.slice(0,c.ks/32),c.salt=s.salt):v.ecc&&t instanceof v.ecc.elGamal.secretKey&&(t=t.unkem(v.codec.base64.toBits(c.kemtag)).slice(0,c.ks/32)),"string"==typeof h&&(h=v.codec.utf8String.toBits(h)),o=new v.cipher[c.cipher](t),r=v.mode[c.mode].decrypt(o,c.ct,c.iv,h,c.ts),a._add(n,c),n.key=t,1===i.raw?r:v.codec.utf8String.fromBits(r)},decrypt:function(t,e,i,n){var r=v.json;return r._decrypt(t,r.decode(e),i,n)},encode:function(t){var e,i="{",n="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new v.exception.invalid("json encode: invalid property name");switch(i+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+v.codec.base64.fromBits(t[e],0)+'"';break;default:throw new v.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new v.exception.invalid("json decode: this isn't json!");var e,i,n=t.replace(/^\{|\}$/g,"").split(/,/),r={};for(e=0;e<n.length;e++){if(!(
i=n[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new v.exception.invalid("json decode: this isn't json!");i[3]?r[i[2]]=parseInt(i[3],10):i[4]?r[i[2]]=i[2].match(/^(ct|salt|iv)$/)?v.codec.base64.toBits(i[4]):unescape(i[4]):i[5]&&(r[i[2]]="true"===i[5])}return r},_add:function(t,e,i){if(t===undefined&&(t={}),e===undefined)return t;var n;for(n in e)if(e.hasOwnProperty(n)){if(i&&t[n]!==undefined&&t[n]!==e[n])throw new v.exception.invalid("required parameter overridden");t[n]=e[n]}return t},_subtract:function(t,e){var i,n={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(n[i]=t[i]);return n},_filter:function(t,e){var i,n={};for(i=0;i<e.length;i++)t[e[i]]!==undefined&&(n[e[i]]=t[e[i]]);return n}},v.encrypt=v.json.encrypt,v.decrypt=v.json.decrypt,v.misc._pbkdf2Cache={},v.misc.cachedPbkdf2=function(t,e){var i,n,r,s,o=v.misc._pbkdf2Cache;return s=(e=e||{}).iter||1e3,(i=(n=o[t]=o[t]||{})[s]=n[s]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):v.random.randomWords(2,0)})[r=e.salt===undefined?i.firstSalt:e.salt]=i[r]||v.misc.pbkdf2(t,r,e.iter),{key:i[r].slice(0),salt:r.slice(0)}},v.bn=function(t){this.initWith(t)},v.bn.prototype={radix:24,maxMul:8,_class:v.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,i=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,i=0;i<t.length;i+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-i-e,0),t.length-i),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)i|=this.getLimb(e)^t.getLimb(e);return 0===i},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,n,r=0,s=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;0<=e;e--)r|=(i=this.getLimb(e))-(n=t.getLimb(e))&~(s|=n-i&~r);return(s|~r)>>>31},toString:function(){this.fullReduce();var t,e,i="",n=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=n[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;i=e+i}return"0x"+i},addM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,i=this.limbs,n=t.limbs;for(e=i.length;e<n.length;e++)i[e]=0;for(e=0;e<n.length;e++)i[e]+=n[e];return this},doubleM:function(){var t,e,i=0,n=this.radix,r=this.radixMask,s=this.limbs;for(t=0;t<s.length;t++)e=(e=s[t])+e+i,s[t]=e&r,i=e>>n;return i&&s.push(i),this},halveM:function(){var t,e,i=0,n=this.radix,r=this.limbs;for(t=r.length-1;0<=t;t--)e=r[t],r[t]=e+i>>1,i=(1&e)<<n;return r[r.length-1]||r.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,i=this.limbs,n=t.limbs;for(e=i.length;e<n.length;e++)i[e]=0;for(e=0;e<n.length;e++)i[e]-=n[e];return this},mod:function(t){var e,i,n=!this.greaterEquals(new v.bn(0));for(t=new v.bn(t).normalize(),e=new v.bn(this).normalize(),i=0,n&&(e=new v.bn(0).subM(e).normalize());e.greaterEquals(t);i++)t.doubleM();for(n&&(e=t.sub(e).normalize());0<i;i--)t.halveM(),e.greaterEquals(t)&&e.subM(t).normalize();return e.trim()},inverseMod:function(t){var e,i,n=new v.bn(1),r=new v.bn(0),s=new v.bn(this),o=new v.bn(t),a=1;if(!(1&t.limbs[0]))throw new v.exception.invalid("inverseMod: p must be odd");do{for(1&s.limbs[0]&&(s.greaterEquals(o)||(e=s,s=o,o=e,e=n,n=r,r=e),s.subM(o),s.normalize(),n.greaterEquals(r)||n.addM(t),n.subM(r)),s.halveM(),1&n.limbs[0]&&n.addM(t),n.normalize(),n.halveM(),i=a=0;i<s.limbs.length;i++)a|=s.limbs[i]}while(a);if(!o.equals(1))throw new v.exception.invalid("inverseMod: p and x must be relatively prime");return r},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,n,r=this.limbs,s=t.limbs,o=r.length,a=s.length,c=new this._class,h=c.limbs,f=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)h[e]=0;for(e=0;e<o;e++){for(n=r[e],i=0;i<a;i++)h[e+i]+=n*s[i];--f||(f=this.maxMul,c.cnormalize())}return c.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs);var e,i,n=new this._class(1),r=this;for(e=0;e<t.length;e++)for(i=0;i<this.radix;i++)t[e]&1<<i&&(n=n.mul(r)),r=r.square();return n},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var i=new v.bn(1),n=new v.bn(this),r=new v.bn(t);1&r.limbs[0]&&(i=i.mulmod(n,e)),r.halveM(),!r.equals(0);)n=n.mulmod(n,e);return i.normalize().reduce()},trim:function(){for(var t,e=this.limbs;t=e.pop(),e.length&&0===t;);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,i=0,n=this.placeVal,r=this.ipv,s=this.limbs,o=s.length,a=this.radixMask;for(t=0;t<o||0!==i&&-1!==i;t++)i=((e=(s[t]||0)+i)-(s[t]=e&a))*r;return-1===i&&(s[t-1]-=n),this},cnormalize:function(){var t,e,i=0,n=this.ipv,r=this.limbs,s=r.length,o=this.radixMask;for(t=0;t<s-1;t++)i=((e=r[t]+i)-(r[t]=e&o))*n;return r[t]+=i,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),i=v.bitArray,n=(t+7&-8)%this.radix||this.radix,r=[i.partial(n,this.getLimb(e))];for(e--;0<=e;e--)r=i.concat(r,[i.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return r},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},v.bn.fromBits=function(t){var e=new this,i=[],n=v.bitArray,r=this.prototype,s=Math.min(this.bitLength||4294967296,n.bitLength(t)),o=s%r.radix||r.radix;for(i[0]=n.extract(t,0,o);o<s;o+=r.radix)i.unshift(n.extract(t,o,r.radix));return e.limbs=i,e},v.bn.prototype.ipv=1/(v.bn.prototype.placeVal=Math.pow(2,v.bn.prototype.radix)),
v.bn.prototype.radixMask=(1<<v.bn.prototype.radix)-1,v.bn.pseudoMersennePrime=function(t,e){function i(t){this.initWith(t)}var n,r,s,o=i.prototype=new v.bn;for(s=o.modOffset=Math.ceil(r=t/o.radix),o.exponent=t,o.offset=[],o.factor=[],o.minOffset=s,o.fullMask=0,o.fullOffset=[],o.fullFactor=[],o.modulus=i.modulus=new v.bn(Math.pow(2,t)),o.fullMask=0|-Math.pow(2,t%o.radix),n=0;n<e.length;n++)o.offset[n]=Math.floor(e[n][0]/o.radix-r),o.fullOffset[n]=Math.ceil(e[n][0]/o.radix-r),o.factor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+o.offset[n]*o.radix),o.fullFactor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+o.fullOffset[n]*o.radix),o.modulus.addM(new v.bn(Math.pow(2,e[n][0])*e[n][1])),o.minOffset=Math.min(o.minOffset,-o.offset[n]);return o._class=i,o.modulus.cnormalize(),o.reduce=function(){var t,e,i,n,r=this.modOffset,s=this.limbs,o=this.offset,a=this.offset.length,c=this.factor;for(t=this.minOffset;s.length>r;){for(i=s.pop(),n=s.length,e=0;e<a;e++)s[n+o[e]]-=c[e]*i;--t||(s.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},o._strongReduce=-1===o.fullMask?o.reduce:function(){var t,e,i=this.limbs,n=i.length-1;if(this.reduce(),n==this.modOffset-1){for(e=i[n]&this.fullMask,i[n]-=e,t=0;t<this.fullOffset.length;t++)i[n+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},o.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},o.inverse=function(){return this.power(this.modulus.sub(2))},i.fromBits=v.bn.fromBits,i},i=v.bn.pseudoMersennePrime,v.bn.prime={p127:i(127,[[0,-1]]),p25519:i(255,[[0,-19]]),p192k:i(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:i(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:i(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:i(192,[[0,-1],[64,-1]]),p224:i(224,[[0,1],[96,-1]]),p256:i(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:i(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:i(521,[[0,-1]])},v.bn.random=function(t,e){"object"!=typeof t&&(t=new v.bn(t));for(var i,n,r=t.limbs.length,s=t.limbs[r-1]+1,o=new v.bn;;){for(;(i=v.random.randomWords(r,e))[r-1]<0&&(i[r-1]+=4294967296),Math.floor(i[r-1]/s)===Math.floor(4294967296/s););for(i[r-1]%=s,n=0;n<r-1;n++)i[n]&=t.radixMask;if(o.limbs=i,!o.greaterEquals(t))return o}},v.ecc={},v.ecc.point=function(t,e,i){e===undefined?this.isIdentity=!0:(e instanceof v.bn&&(e=new t.field(e)),i instanceof v.bn&&(i=new t.field(i)),this.x=e,this.y=i,this.isIdentity=!1),this.curve=t},v.ecc.point.prototype={toJac:function(){return new v.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,i){return this.toJac().mult2(t,this,e,i).toAffine()},multiples:function(){var t,e,i;if(this._multiples===undefined)for(i=this.toJac().doubl(),t=this._multiples=[new v.ecc.point(this.curve),this,i.toAffine()],e=3;e<16;e++)i=i.add(this),t.push(i.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return v.bitArray.concat(this.x.toBits(),this.y.toBits())}},v.ecc.pointJac=function(t,e,i,n){e===undefined?this.isIdentity=!0:(this.x=e,this.y=i,this.z=n,this.isIdentity=!1),this.curve=t},v.ecc.pointJac.prototype={add:function(t){var e,i,n,r,s,o,a,c,h,f,u,l=this;if(l.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return l.isIdentity?t.toJac():t.isIdentity?l:(e=l.z.square(),(i=t.x.mul(e).subM(l.x)).equals(0)?l.y.equals(t.y.mul(e.mul(l.z)))?l.doubl():new v.ecc.pointJac(l.curve):(n=t.y.mul(e.mul(l.z)).subM(l.y),r=i.square(),s=n.square(),o=i.square().mul(i).addM(l.x.add(l.x).mul(r)),a=s.subM(o),c=l.x.mul(r).subM(a).mul(n),h=l.y.mul(i.square().mul(i)),f=c.subM(h),u=l.z.mul(i),new v.ecc.pointJac(this.curve,a,f,u)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),i=t.square().mul(8),n=this.z.square(),r=this.curve.a.toString()==new v.bn(-3).toString()?this.x.sub(n).mul(3).mul(this.x.add(n)):this.x.square().mul(3).add(n.square().mul(this.curve.a)),s=r.square().subM(e).subM(e),o=e.sub(s).mul(r).subM(i),a=this.y.add(this.y).mul(this.z);return new v.ecc.pointJac(this.curve,s,o,a)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new v.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new v.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs);var i,n,r=new v.ecc.point(this.curve).toJac(),s=e.multiples();for(i=t.length-1;0<=i;i--)for(n=v.bn.prototype.radix-4;0<=n;n-=4)r=r.doubl().doubl().doubl().doubl().add(s[t[i]>>n&15]);return r},mult2:function(t,e,i,n){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs),"number"==typeof i?i=[i]:i.limbs!==undefined&&(i=i.normalize().limbs);var r,s,o,a,c=new v.ecc.point(this.curve).toJac(),h=e.multiples(),f=n.multiples();for(r=Math.max(t.length,i.length)-1;0<=r;r--)for(o=0|t[r],a=0|i[r],s=v.bn.prototype.radix-4;0<=s;s-=4)c=c.doubl().doubl().doubl().doubl().add(h[o>>s&15]).add(f[a>>s&15]);return c},isValid:function(){var t=this.z.square(),e=t.square(),i=e.mul(t);return this.y.square().equals(this.curve.b.mul(i).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},v.ecc.curve=function(t,e,i,n,r,s){this.field=t,this.r=new v.bn(e),this.a=new t(i),this.b=new t(n),this.G=new v.ecc.point(this,new t(r),new t(s))},v.ecc.curve.prototype.fromBits=function(t){var e=v.bitArray,i=this.field.prototype.exponent+7&-8,n=new v.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,i)),this.field.fromBits(e.bitSlice(t,i,2*i)));if(!n.isValid())throw new v.exception.corrupt(
"not on the curve!");return n},v.ecc.curves={c192:new v.ecc.curve(v.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new v.ecc.curve(v.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new v.ecc.curve(v.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new v.ecc.curve(v.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new v.ecc.curve(v.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new v.ecc.curve(v.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new v.ecc.curve(v.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},v.ecc.basicKey={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),e instanceof Array?this._point=t.fromBits(e):this._point=e,this.get=function(){var t=this._point.toBits(),e=v.bitArray.bitLength(t),i=v.bitArray.bitSlice(t,0,e/2),n=v.bitArray.bitSlice(t,e/2);return{x:i,y:n}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}}},v.ecc.basicKey.generateKeys=function(r){return function(t,e,i){if("number"==typeof(t=t||256)&&(t=v.ecc.curves["c"+t])===undefined)throw new v.exception.invalid("no such curve");i=i||v.bn.random(t.r,e);var n=t.G.mult(i);return{pub:new v.ecc[r].publicKey(t,n),sec:new v.ecc[r].secretKey(t,i)}}},v.ecc.elGamal={generateKeys:v.ecc.basicKey.generateKeys("elGamal"),publicKey:function(t,e){v.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(t,e){v.ecc.basicKey.secretKey.apply(this,arguments)}},v.ecc.elGamal.publicKey.prototype={kem:function(t){var e=v.bn.random(this._curve.r,t),i=this._curve.G.mult(e).toBits();return{key:v.hash.sha256.hash(this._point.mult(e).toBits()),tag:i}}},v.ecc.elGamal.secretKey.prototype={unkem:function(t){return v.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return v.hash.sha256.hash(t._point.mult(this._exponent).toBits())},dhJavaEc:function(t){return t._point.mult(this._exponent).x.toBits()}},v.ecc.ecdsa={generateKeys:v.ecc.basicKey.generateKeys("ecdsa")},v.ecc.ecdsa.publicKey=function(t,e){v.ecc.basicKey.publicKey.apply(this,arguments)},v.ecc.ecdsa.publicKey.prototype={verify:function(t,e,i){v.bitArray.bitLength(t)>this._curveBitLength&&(t=v.bitArray.clamp(t,this._curveBitLength));var n=v.bitArray,r=this._curve.r,s=this._curveBitLength,o=v.bn.fromBits(n.bitSlice(e,0,s)),a=v.bn.fromBits(n.bitSlice(e,s,2*s)),c=i?a:a.inverseMod(r),h=v.bn.fromBits(t).mul(c).mod(r),f=o.mul(c).mod(r),u=this._curve.G.mult2(h,f,this._point).x;if(o.equals(0)||a.equals(0)||o.greaterEquals(r)||a.greaterEquals(r)||!u.equals(o)){if(i===undefined)return this.verify(t,e,!0);throw new v.exception.corrupt("signature didn't check out")}return!0}},v.ecc.ecdsa.secretKey=function(t,e){v.ecc.basicKey.secretKey.apply(this,arguments)},v.ecc.ecdsa.secretKey.prototype={sign:function(t,e,i,n){v.bitArray.bitLength(t)>this._curveBitLength&&(t=v.bitArray.clamp(t,this._curveBitLength));var r=this._curve.r,s=r.bitLength(),o=n||v.bn.random(r.sub(1),e).add(1),a=this._curve.G.mult(o).x.mod(r),c=v.bn.fromBits(t).add(a.mul(this._exponent)),h=i?c.inverseMod(r).mul(o).mod(r):c.mul(o.inverseMod(r)).mod(r);return v.bitArray.concat(a.toBits(s),h.toBits(s))}},v.keyexchange.srp={makeVerifier:function(t,e,i,n){var r;return r=v.keyexchange.srp.makeX(t,e,i),r=v.bn.fromBits(r),n.g.powermod(r,n.N)},makeX:function(t,e,i){var n=v.hash.sha1.hash(t+":"+e);return v.hash.sha1.hash(v.bitArray.concat(i,n))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),v.keyexchange.srp._didInitKnownGroups||v.keyexchange.srp._initKnownGroups(),v.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){var t,e,i;for(t=0;t<v.keyexchange.srp._knownGroupSizes.length;t++)e=v.keyexchange.srp._knownGroupSizes[t].toString(),(i=v.keyexchange.srp._knownGroups[e]).N=new v.bn(i.N),i.g=new v.bn(i.g);v.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{
N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},t.Crypto=t.Crypto||{},t.Crypto.sjcl=v},"@VERSION@",{requires:[]});